<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin • Orders</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; background:#0b1220; color:#e5e7eb; margin:0; }
    .wrap { max-width:1100px; margin:0 auto; padding:18px; }
    .top { display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:14px; }
    .title { font-size:22px; font-weight:900; }
    .meta { color:#94a3b8; font-size:13px; }
    .btn { border:1px solid rgba(255,255,255,.14); background:#111827; color:#e5e7eb; padding:10px 12px; border-radius:12px; cursor:pointer; }
    table { width:100%; border-collapse:collapse; overflow:hidden; border-radius:14px; border:1px solid rgba(255,255,255,.08); }
    th, td { padding:12px 10px; border-bottom:1px solid rgba(255,255,255,.08); vertical-align:top; }
    th { text-align:left; color:#94a3b8; font-size:12px; letter-spacing:.3px; text-transform:uppercase; background:#0f172a; }
    tr:hover td { background: rgba(255,255,255,.03); }
    a { color:#a5b4fc; text-decoration:none; font-weight:800; }
    .pill { display:inline-block; padding:4px 10px; border-radius:999px; background:rgba(99,102,241,.18); border:1px solid rgba(99,102,241,.35); font-size:12px; font-weight:800; }
    .pager { display:flex; gap:8px; align-items:center; margin-top:14px; flex-wrap:wrap; }
    .page { padding:8px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.12); background:#111827; color:#e5e7eb; text-decoration:none; font-weight:800; }
    .page.active { background:#6366f1; border-color:#6366f1; }
    .muted { color:#94a3b8; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div>
        <div class="title">Orders</div>
        <div class="meta">Total: {{ total }} • Page {{ page }} / {{ pages }}</div>
      </div>
      <form method="post" action="/admin/logout">
        <button class="btn" type="submit">Logout</button>
      </form>
    </div>

    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Date</th>
          <th>Name</th>
          <th>Phone</th>
          <th>Model</th>
          <th>Status</th>
          <th>Design</th>
        </tr>
      </thead>
      <tbody>
        {% for o in orders %}
        <tr>
          <td><a href="/admin/orders/{{ o.id }}">#{{ o.id }}</a></td>
          <td class="muted">{{ o.order_date }}</td>
          <td>{{ o.c_name or "-" }}</td>
          <td>{{ o.phone_number or "-" }}</td>
          <td class="muted">{{ (o.brand or "-") ~ " / " ~ (o.phone_model or "-") }}</td>
          <td><span class="pill">{{ o.status or "pending" }}</span></td>
          <td>
            {% if o.design_url %}
              <a href="{{ o.design_url }}" target="_blank">open</a>
            {% else %}
              <span class="muted">-</span>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <div class="pager">
      {% if page > 1 %}
        <a class="page" href="/admin/orders?page={{ page - 1 }}">← Prev</a>
      {% endif %}

      {# простая пагинация вокруг текущей #}
      {% set start = 1 if page - 2 < 1 else page - 2 %}
      {% set end = pages if page + 2 > pages else page + 2 %}

      {% if start > 1 %}
        <a class="page" href="/admin/orders?page=1">1</a>
        <span class="muted">…</span>
      {% endif %}

      {% for p in range(start, end + 1) %}
        <a class="page {% if p == page %}active{% endif %}" href="/admin/orders?page={{ p }}">{{ p }}</a>
      {% endfor %}

      {% if end < pages %}
        <span class="muted">…</span>
        <a class="page" href="/admin/orders?page={{ pages }}">{{ pages }}</a>
      {% endif %}

      {% if page < pages %}
        <a class="page" href="/admin/orders?page={{ page + 1 }}">Next →</a>
      {% endif %}
    </div>
  </div>
</body>
</html>
