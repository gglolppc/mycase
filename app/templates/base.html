<!-- base.html -->
<!DOCTYPE html>
<html lang="ro" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  {% block title %}<title>MYCASE</title>{% endblock %}
  {% block meta %}
  <meta name="description" content="CreeazÄƒ produse personalizate. Calitate premium, livrare rapidÄƒ Ã®n Moldova." />
  <meta name="keywords" content="personalizat, mycase, ChiÈ™inÄƒu, Moldova" />
  {% endblock %}

  <!-- Theme init BEFORE paint (no flash) -->
  <script>
    (function () {
      try {
        const saved = localStorage.getItem('theme');
        if (saved === 'dark') document.documentElement.classList.add('dark');
      } catch (e) {}
    })();
  </script>

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-KRN1WNWTXK"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-KRN1WNWTXK');
  </script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@500;600&display=swap" rel="stylesheet">
  {% block extra_fonts %}{% endblock %}

  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            accent: '#6366F1',
            'bg-light': '#F8FAFC',
            glass: 'rgba(255, 255, 255, 0.75)',
          },
          fontFamily: { sans: ['Inter', 'sans-serif'] },
        }
      }
    }
  </script>

  <script src="https://cdn.jsdelivr.net/npm/fabric@latest/dist/fabric.min.js"></script>
  <script>const STATIC_BASE = "{{ request.url_for('static', path='') }}";</script>

  <style type="text/tailwindcss">
    .glass {
      @apply bg-white/70 dark:bg-gray-900/60
             backdrop-blur-md
             border border-white/30 dark:border-white/10;
    }

    .neumorphic {
      @apply bg-white/80 dark:bg-gray-900/60
             shadow-xl shadow-black/5 dark:shadow-black/40;
    }

    .neumorphic-btn {
      @apply bg-white/90 dark:bg-gray-900/70
             text-gray-800 dark:text-gray-100
             shadow-inner shadow-gray-400/20 dark:shadow-black/50
             hover:shadow-md dark:hover:shadow-black/60
             hover:-translate-y-0.5 transition-all duration-300
             border border-transparent dark:border-white/10;
    }

    .fade-in { animation: fadeIn 0.5s ease-out forwards; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px) scale(0.98); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }
  </style>

  {% block extra_styles %}{% endblock %}
</head>

<body class="bg-bg-light text-gray-800 dark:bg-gray-950 dark:text-gray-100 min-h-screen flex flex-col">

  {% set p = request.url.path %}

  <!-- Header -->
<header class="bg-white/90 dark:bg-gray-900/80 backdrop-blur-md shadow-sm py-3 sm:py-5 sticky top-0 z-50 border-b border-gray-100 dark:border-white/10">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 flex justify-between items-center gap-3">

    <!-- Left: logo -->
    <div class="flex items-center gap-3 sm:gap-8 min-w-0">
      <a href="/" class="flex items-center gap-3 sm:gap-4 group shrink-0">
        <img src="{{ request.url_for('static', path='assets/logo.png') }}" alt="MYCASE"
             class="w-10 h-10 sm:w-12 sm:h-12 rounded-full shadow-md group-hover:scale-105 transition-transform"/>
        <div class="hidden sm:block">
          <h1 class="text-2xl font-bold text-accent">MYCASE</h1>
          <p class="text-sm text-gray-500 dark:text-gray-400">
            {% block header_subtitle %}Produse premium la comandÄƒ{% endblock %}
          </p>
        </div>
      </a>

      <!-- Desktop nav -->
      <nav class="hidden sm:flex items-center gap-6">
        <a href="/huse_personalizate"
           class="text-sm font-bold uppercase tracking-wide hover:text-accent transition-colors
           {% if p.startswith('/huse_personalizate') %}text-accent border-b-2 border-accent{% else %}text-gray-600 dark:text-gray-300{% endif %}">
          Huse personalizate
        </a>

        <a href="/termos"
           class="text-sm font-bold uppercase tracking-wide hover:text-accent transition-colors
           {% if p.startswith('/termos') %}text-accent border-b-2 border-accent{% else %}text-gray-600 dark:text-gray-300{% endif %}">
          Termosuri personalizate
        </a>

        <a href="/designuri"
           class="text-sm font-bold uppercase tracking-wide hover:text-accent transition-colors
           {% if p.startswith('/designuri') %}text-accent border-b-2 border-accent{% else %}text-gray-600 dark:text-gray-300{% endif %}">
          Designurile noastre
        </a>
      </nav>
    </div>

    <!-- Right: actions -->
    <div class="flex items-center gap-3 sm:gap-4 shrink-0">

      <!-- Mobile burger -->
      <button
        id="mobile-menu-btn"
        class="sm:hidden neumorphic-btn px-4 py-3 rounded-2xl font-semibold flex items-center justify-center"
        type="button"
        aria-label="Open menu"
        aria-expanded="false"
      >
        <i id="mobile-menu-icon" class="fas fa-bars"></i>
      </button>

      <button
        id="theme-toggle"
        class="neumorphic-btn px-4 py-3 rounded-2xl font-semibold flex items-center gap-2"
        type="button"
        aria-label="Toggle theme"
        title="Theme"
      >
        <i id="theme-icon" class="fas fa-moon"></i>
      </button>

      <div class="hidden sm:flex items-center gap-4">
        <a href="https://t.me/mycasemd" class="text-gray-700 dark:text-gray-200 hover:text-accent transition">
          <i class="fab fa-telegram text-xl"></i>
        </a>
        <a href="viber://chat?number=%2B37369214888" class="text-gray-700 dark:text-gray-200 hover:text-accent transition">
          <i class="fab fa-viber text-xl"></i>
        </a>
      </div>
    </div>
  </div>

  <!-- Mobile dropdown -->
  <div id="mobile-menu-overlay" class="sm:hidden fixed inset-0 bg-black/40 hidden z-40"></div>

  <div id="mobile-menu" class="sm:hidden hidden relative z-50">
    <div class="px-4 pb-4">
      <div class="glass rounded-3xl p-4 border border-white/30 dark:border-white/10 shadow-xl">
        <div class="flex flex-col gap-2">
          <a href="/huse_personalizate"
             class="px-4 py-3 rounded-2xl font-bold uppercase tracking-wide hover:bg-black/5 dark:hover:bg-white/5 transition
             {% if p.startswith('/huse_personalizate') %}text-accent{% else %}text-gray-700 dark:text-gray-200{% endif %}">
            Huse personalizate
          </a>

          <a href="/termos"
             class="px-4 py-3 rounded-2xl font-bold uppercase tracking-wide hover:bg-black/5 dark:hover:bg-white/5 transition
             {% if p.startswith('/termos') %}text-accent{% else %}text-gray-700 dark:text-gray-200{% endif %}">
            Termosuri personalizate
          </a>

          <a href="/designuri"
             class="px-4 py-3 rounded-2xl font-bold uppercase tracking-wide hover:bg-black/5 dark:hover:bg-white/5 transition
             {% if p.startswith('/designuri') %}text-accent{% else %}text-gray-700 dark:text-gray-200{% endif %}">
            Designurile noastre
          </a>

          <div class="h-px bg-gray-200/70 dark:bg-white/10 my-2"></div>

          <div class="flex items-center gap-4 px-2">
            <a href="https://t.me/mycasemd" class="text-gray-700 dark:text-gray-200 hover:text-accent transition">
              <i class="fab fa-telegram text-2xl"></i>
            </a>
            <a href="viber://chat?number=%2B37369214888" class="text-gray-700 dark:text-gray-200 hover:text-accent transition">
              <i class="fab fa-viber text-2xl"></i>
            </a>
            <a href="tel:+373 69 214 888" class="text-gray-700 dark:text-gray-200 hover:text-accent transition">
              <i class="fas fa-phone text-2xl"></i>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>


  {% block main %}{% endblock %}

  {% block examples %}
  <section class="py-16 px-6 bg-gradient-to-b from-transparent to-gray-50 dark:to-gray-950">
    <div class="max-w-7xl mx-auto">
      <h2 class="text-4xl font-bold text-center text-accent mb-12">âœ¨ Exemplele lucrÄƒrilor noastre</h2>

      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-6">
        {% for i in range(1, 6) %}
        <div class="group relative overflow-hidden rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-500">
          <img src="{{ request.url_for('static', path='assets/examples/' ~ i ~ '.jpg') }}"
               alt="Exemplu personalizat"
               class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" />
          <div class="absolute inset-0 bg-gradient-to-t from-black/40 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
        </div>
        {% endfor %}
      </div>

      <p class="text-center text-gray-600 dark:text-gray-300 mt-10 text-lg">È˜i a ta va fi la fel de frumoasÄƒ âœ¨</p>
    </div>
  </section>
  {% endblock %}

  {% block mobile_bar %}{% endblock %}

  <!-- ÐœÐ¾Ð´Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¾ÐºÐ½Ð¾ Ð·Ð°ÐºÐ°Ð·Ð° -->
  <div id="order-form" class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center hidden z-50 transition-all duration-300">
    <div class="bg-white dark:bg-gray-900 rounded-3xl p-10 max-w-md w-full mx-6 shadow-2xl border border-gray-100 dark:border-white/10">
      <h2 class="text-3xl font-bold text-accent mb-8 text-center">Finalizare comandÄƒ</h2>
      <form id="order-form-el" class="space-y-6">
        <input type="text" name="name" placeholder="Numele tÄƒu" required
               class="w-full p-5 rounded-2xl border border-gray-300 dark:border-white/10 bg-gray-50 dark:bg-gray-950/40
                      text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400
                      focus:ring-4 focus:ring-accent/30 focus:border-accent transition" />
        <input type="text" name="phone" placeholder="Telefon" required
               class="w-full p-5 rounded-2xl border border-gray-300 dark:border-white/10 bg-gray-50 dark:bg-gray-950/40
                      text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400
                      focus:ring-4 focus:ring-accent/30 focus:border-accent transition" />
        <input type="text" name="address" placeholder="Adresa de livrare" required
               class="w-full p-5 rounded-2xl border border-gray-300 dark:border-white/10 bg-gray-50 dark:bg-gray-950/40
                      text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400
                      focus:ring-4 focus:ring-accent/30 focus:border-accent transition" />

        {% block order_form_extra %}{% endblock %}

        <div class="flex justify-end gap-4 mt-10">
          <button type="button" id="cancel-order"
                  class="px-8 py-4 rounded-2xl border border-gray-300 dark:border-white/10 text-gray-700 dark:text-gray-100 font-semibold hover:bg-gray-100 dark:hover:bg-white/5 transition">
            Anulare
          </button>

          <button type="submit" id="submit-order-btn"
                  class="relative px-10 py-4 rounded-2xl bg-accent text-white font-bold hover:bg-indigo-700 transition shadow-lg w-full">
            <span id="submit-text">ComandÄƒ acum</span>
            <span id="loading-text" class="hidden flex items-center justify-center">
              <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
              Se trimite ordine...
            </span>
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="fixed bottom-8 left-1/2 -translate-x-1/2 bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100 px-8 py-4 rounded-2xl shadow-2xl border-t-4 border-green-500 opacity-0 pointer-events-none transition-opacity duration-300 z-50 font-bold">
    ComandÄƒ primitÄƒ! Te vom contacta Ã®n curÃ¢nd ðŸ“ž
  </div>

  {% block scripts %}{% endblock %}

  <!-- Footer -->
  <footer class="bg-white/70 dark:bg-gray-900/60 backdrop-blur-md border-t border-gray-200 dark:border-white/10 mt-20">
    <div class="max-w-7xl mx-auto px-6 py-10">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center md:text-left">
        <div class="flex flex-col items-center md:items-start">
          <div class="flex items-center gap-3 mb-4">
            <img src="{{ request.url_for('static', path='assets/logo.png') }}" alt="MYCASE" class="w-10 h-10 rounded-full shadow-md"/>
            <h3 class="text-2xl font-bold text-accent">MYCASE</h3>
          </div>
          <p class="text-sm text-gray-600 dark:text-gray-300">{% block footer_subtitle %}Produse premium personalizate<br>ChiÈ™inÄƒu Â· Moldova Â· 2025{% endblock %}</p>
        </div>

        <div class="space-y-3">
          <p class="text-sm font-semibold text-gray-700 dark:text-gray-200 uppercase tracking-wider">Contact</p>
          <div class="space-y-2 text-gray-600 dark:text-gray-300">
            <p class="flex items-center justify-center md:justify-start gap-2">
              <i class="fab fa-telegram text-accent"></i> @mycasemd
            </p>
            <p class="flex items-center justify-center md:justify-start gap-2">
              <i class="fab fa-viber text-accent"></i> +373 69 214 888
            </p>
            <p class="flex items-center justify-center md:justify-start gap-2">
              <i class="fas fa-map-marker-alt text-accent"></i> bd. Moscova 11, RÃ®È™cani
            </p>
          </div>
        </div>

        <div class="space-y-3">
          <p class="text-sm font-semibold text-gray-700 dark:text-gray-200 uppercase tracking-wider">Info</p>
          <div class="text-sm text-gray-600 dark:text-gray-300 space-y-1">
            <p>Livrare Ã®n toatÄƒ Moldova (de la 50 lei)</p>
            <p>Plata la primire (ramburs)</p>
            <p>GaranÈ›ie calitate print UV</p>
            <p class="text-xs text-gray-500 dark:text-gray-400 mt-4">Â© 2025 MYCASE. Toate drepturile rezervate.</p>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <!-- Floating Contact Button -->
  <div id="floating-contact" class="fixed bottom-28 right-4 z-40 flex flex-col items-end gap-4">
    <div id="contact-buttons" class="flex flex-col items-end gap-3 opacity-0 scale-0 transition-all duration-300 origin-bottom-right">
      <a href="https://t.me/mycasemd" target="_blank" class="bg-blue-600 text-white p-4 rounded-full shadow-2xl hover:scale-110 transition transform">
        <i class="fab fa-telegram text-2xl"></i>
      </a>
      <a href="viber://chat?number=%2B37369214888" class="bg-purple-600 text-white p-4 rounded-full shadow-2xl hover:scale-110 transition transform">
        <i class="fab fa-viber text-2xl"></i>
      </a>
      <a href="tel:+373 69 214 888" class="bg-green-600 text-white p-4 rounded-full shadow-2xl hover:scale-110 transition transform">
        <i class="fas fa-phone text-2xl"></i>
      </a>
      <button onclick="document.querySelector('footer').scrollIntoView({behavior: 'smooth'})" class="bg-accent text-white p-4 rounded-full shadow-2xl hover:scale-110 transition transform">
        <i class="fas fa-arrow-down text-2xl"></i>
      </button>
    </div>

    <button id="toggle-contact" class="bg-accent text-white p-5 rounded-full shadow-2xl hover:scale-110 transition transform pulse-animation">
      <i id="toggle-icon" class="fas fa-comment-dots text-3xl"></i>
    </button>
  </div>

  <style>
    #phone-canvas, #canvas-container, canvas { touch-action: none; }
    body { overflow-x: hidden; }

    .pulse-animation { animation: pulse 2s infinite; }
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.7); }
      70% { box-shadow: 0 0 0 10px rgba(99, 102, 241, 0); }
      100% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0); }
    }
  </style>

  <!-- Global JS -->
  <script src="{{ request.url_for('static', path='js/theme.js') }}"></script>

  <script>
    // Floating contact toggle (safe)
    const toggleBtn = document.getElementById('toggle-contact');
    const contactButtons = document.getElementById('contact-buttons');
    const toggleIcon = document.getElementById('toggle-icon');

    if (toggleBtn && contactButtons && toggleIcon) {
      toggleBtn.addEventListener('click', () => {
        const closed = contactButtons.classList.contains('opacity-0');
        contactButtons.classList.toggle('opacity-0', !closed);
        contactButtons.classList.toggle('scale-0', !closed);
        contactButtons.classList.toggle('opacity-100', closed);
        contactButtons.classList.toggle('scale-100', closed);

        toggleIcon.classList.toggle('fa-comment-dots', !closed);
        toggleIcon.classList.toggle('fa-times', closed);
      });
    }
      (function () {
    const btn = document.getElementById('mobile-menu-btn');
    const icon = document.getElementById('mobile-menu-icon');
    const menu = document.getElementById('mobile-menu');
    const overlay = document.getElementById('mobile-menu-overlay');

    if (!btn || !menu || !overlay || !icon) return;

    function openMenu() {
      menu.classList.remove('hidden');
      overlay.classList.remove('hidden');
      btn.setAttribute('aria-expanded', 'true');
      icon.classList.remove('fa-bars');
      icon.classList.add('fa-times');
    }

    function closeMenu() {
      menu.classList.add('hidden');
      overlay.classList.add('hidden');
      btn.setAttribute('aria-expanded', 'false');
      icon.classList.add('fa-bars');
      icon.classList.remove('fa-times');
    }

    function toggleMenu() {
      const isOpen = !menu.classList.contains('hidden');
      isOpen ? closeMenu() : openMenu();
    }

    btn.addEventListener('click', toggleMenu);
    overlay.addEventListener('click', closeMenu);

    // Ð—Ð°ÐºÑ€Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¿Ð¾ Esc
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeMenu();
    });

    // Ð—Ð°ÐºÑ€Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¿Ð¾ÑÐ»Ðµ ÐºÐ»Ð¸ÐºÐ° Ð¿Ð¾ ÑÑÑ‹Ð»ÐºÐµ
    menu.querySelectorAll('a').forEach(a => a.addEventListener('click', closeMenu));
  })();
  </script>

</body>
</html>
